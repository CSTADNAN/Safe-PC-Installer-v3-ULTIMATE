# Safe-PC-Installer-v3.1.ps1
# 100% Safe â€¢ No Registry â€¢ No File Deletion â€¢ Only Winget
# 108 Essential Apps - COLOR CODED & ORGANIZED
# Made by: MD Adnan | October 2025

#Requires -RunAsAdministrator

Clear-Host

# Color Scheme
$script:Colors = @{
    Primary = "Cyan"
    Success = "Green"
    Warning = "Yellow"
    Error = "Red"
    Info = "White"
    Highlight = "Magenta"
}

# ğŸ›¡ï¸ COMPLETE SOFTWARE LIST (108 Apps)
$softwareList = @(
    # ğŸŒ Browsers (1-6)
    @{Name="ğŸŒ Chrome"; Id="Google.Chrome"; Category="Browsers"; Color="Cyan"},
    @{Name="ğŸ¦Š Firefox"; Id="Mozilla.Firefox"; Category="Browsers"; Color="Cyan"},
    @{Name="ğŸ”´ Opera"; Id="Opera.Opera"; Category="Browsers"; Color="Cyan"},
    @{Name="ğŸªŸ Edge"; Id="Microsoft.Edge"; Category="Browsers"; Color="Cyan"},
    @{Name="ğŸ¦ Brave"; Id="Brave.Brave"; Category="Browsers"; Color="Cyan"},
    @{Name="ğŸ”· Arc"; Id="TheBrowserCompany.Arc"; Category="Browsers"; Color="Cyan"},

    # ğŸ“¡ Communication (7-13)
    @{Name="ğŸ“ Zoom"; Id="Zoom.Zoom"; Category="Communication"; Color="Green"},
    @{Name="ğŸ’¬ Discord"; Id="Discord.Discord"; Category="Communication"; Color="Green"},
    @{Name="ğŸ‘¥ Teams"; Id="Microsoft.Teams"; Category="Communication"; Color="Green"},
    @{Name="ğŸ¦ Pidgin"; Id="Pidgin.Pidgin"; Category="Communication"; Color="Green"},
    @{Name="ğŸ“§ Thunderbird"; Id="Mozilla.Thunderbird"; Category="Communication"; Color="Green"},
    @{Name="â˜ï¸ Skype"; Id="Microsoft.Skype"; Category="Communication"; Color="Green"},
    @{Name="ğŸ’š WhatsApp"; Id="9NKSQGP7F2NH"; Category="Communication"; Color="Green"},

    # ğŸµ Multimedia (14-20)
    @{Name="ğŸ¥ VLC"; Id="VideoLAN.VLC"; Category="Media"; Color="Magenta"},
    @{Name="ğŸµ AIMP"; Id="AIMP.AIMP"; Category="Media"; Color="Magenta"},
    @{Name="ğŸ¶ foobar2000"; Id="PeterPawlowski.foobar2000"; Category="Media"; Color="Magenta"},
    @{Name="ğŸ§ Winamp"; Id="Winamp.Winamp"; Category="Media"; Color="Magenta"},
    @{Name="ğŸ™ï¸ Audacity"; Id="Audacity.Audacity"; Category="Media"; Color="Magenta"},
    @{Name="ğŸµ Spotify"; Id="Spotify.Spotify"; Category="Media"; Color="Magenta"},
    @{Name="ğŸ¬ OBS Studio"; Id="OBSProject.OBSStudio"; Category="Media"; Color="Magenta"},

    # ğŸ¨ Graphics (21-29)
    @{Name="ğŸ¨ Krita"; Id="KDE.Krita"; Category="Graphics"; Color="Yellow"},
    @{Name="ğŸ–Œï¸ Paint.NET"; Id="dotPDN.PaintDotNet"; Category="Graphics"; Color="Yellow"},
    @{Name="ğŸ¨ GIMP"; Id="GIMP.GIMP"; Category="Graphics"; Color="Yellow"},
    @{Name="ğŸ–¼ï¸ IrfanView"; Id="IrfanSkiljan.IrfanView"; Category="Graphics"; Color="Yellow"},
    @{Name="ğŸ–¼ï¸ XnView"; Id="XnSoft.XnView"; Category="Graphics"; Color="Yellow"},
    @{Name="âœ’ï¸ Inkscape"; Id="Inkscape.Inkscape"; Category="Graphics"; Color="Yellow"},
    @{Name="ğŸ“¸ FastStone"; Id="FastStone.Capture"; Category="Graphics"; Color="Yellow"},
    @{Name="ğŸ“· Greenshot"; Id="Greenshot.Greenshot"; Category="Graphics"; Color="Yellow"},
    @{Name="ğŸ“¤ ShareX"; Id="ShareX.ShareX"; Category="Graphics"; Color="Yellow"},

    # ğŸ“• Documents (30-34)
    @{Name="ğŸ“• Foxit Reader"; Id="Foxit.FoxitReader"; Category="Documents"; Color="White"},
    @{Name="ğŸ“‘ LibreOffice"; Id="TheDocumentFoundation.LibreOffice"; Category="Documents"; Color="White"},
    @{Name="ğŸ“„ SumatraPDF"; Id="SumatraPDF.SumatraPDF"; Category="Documents"; Color="White"},
    @{Name="ğŸ–¨ï¸ CutePDF"; Id="Acro.CutePDF"; Category="Documents"; Color="White"},
    @{Name="ğŸ“• Adobe Reader"; Id="Adobe.Acrobat.Reader.64-bit"; Category="Documents"; Color="White"},

    # ğŸ“Š Office (35-37)
    @{Name="ğŸ“Š MS Office 365"; Id="Microsoft.Office"; Category="Office"; Color="Blue"},
    @{Name="ğŸ‡§ğŸ‡© Bijoy Bayanno"; Id="OmicronLab.BijoyBayanno"; Category="Office"; Color="Blue"},
    @{Name="ğŸ“¦ MS 365 Setup"; Id="Microsoft.Microsoft365Apps"; Category="Office"; Color="Blue"},

    # ğŸ›¡ï¸ Security (38-44)
    @{Name="ğŸ›¡ï¸ Malwarebytes"; Id="Malwarebytes.Malwarebytes"; Category="Security"; Color="Red"},
    @{Name="ğŸ›¡ï¸ Avast"; Id="Avast.Avast.Free"; Category="Security"; Color="Red"},
    @{Name="ğŸ¦  AVG"; Id="AVG.AntiVirusFree"; Category="Security"; Color="Red"},
    @{Name="ğŸ•·ï¸ Spybot"; Id="SaferNetworking.SpybotAntiBeacon"; Category="Security"; Color="Red"},
    @{Name="ğŸ”’ Avira"; Id="Avira.Avira"; Category="Security"; Color="Red"},
    @{Name="ğŸ›¡ï¸ SUPERAntiSpyware"; Id="SUPERAntiSpyware.SUPERAntiSpyware"; Category="Security"; Color="Red"},
    @{Name="ğŸ” KeePass 2"; Id="DominikReichl.KeePass"; Category="Security"; Color="Red"},

    # ğŸŒ Cloud & Network (45-51)
    @{Name="ğŸŒ qBittorrent"; Id="qBittorrent.qBittorrent"; Category="Network"; Color="Cyan"},
    @{Name="â˜ï¸ Dropbox"; Id="Dropbox.Dropbox"; Category="Cloud"; Color="Cyan"},
    @{Name="â˜ï¸ Google Drive"; Id="Google.Drive"; Category="Cloud"; Color="Cyan"},
    @{Name="â˜ï¸ OneDrive"; Id="Microsoft.OneDrive"; Category="Cloud"; Color="Cyan"},
    @{Name="â˜ï¸ SugarSync"; Id="SugarSync.SugarSync"; Category="Cloud"; Color="Cyan"},
    @{Name="ğŸ“ Evernote"; Id="Evernote.Evernote"; Category="Cloud"; Color="Cyan"},
    @{Name="ğŸŒ Google Earth"; Id="Google.EarthPro"; Category="Network"; Color="Cyan"},

    # ğŸ® Gaming (52-53)
    @{Name="ğŸ® Steam"; Id="Valve.Steam"; Category="Gaming"; Color="Magenta"},
    @{Name="ğŸ® Epic Games"; Id="EpicGames.EpicGamesLauncher"; Category="Gaming"; Color="Magenta"},

    # ğŸ” Utilities (54-74)
    @{Name="ğŸ” Everything"; Id="voidtools.Everything"; Category="Utilities"; Color="Gray"},
    @{Name="ğŸ‘ï¸ NVDA"; Id="NVAccess.NVDA"; Category="Utilities"; Color="Gray"},
    @{Name="ğŸ–¥ï¸ AnyDesk"; Id="AnyDeskSoftwareGmbH.AnyDesk"; Category="Utilities"; Color="Gray"},
    @{Name="ğŸ–¥ï¸ TeamViewer"; Id="TeamViewer.TeamViewer"; Category="Utilities"; Color="Gray"},
    @{Name="ğŸ’¿ ImgBurn"; Id="LIGHTNINGUK.ImgBurn"; Category="Utilities"; Color="Gray"},
    @{Name="ğŸ–¥ï¸ RealVNC Server"; Id="RealVNC.VNCServer"; Category="Utilities"; Color="Gray"},
    @{Name="ğŸ–¥ï¸ RealVNC Viewer"; Id="RealVNC.VNCViewer"; Category="Utilities"; Color="Gray"},
    @{Name="ğŸ–¥ï¸ TightVNC"; Id="GlavSoft.TightVNC"; Category="Utilities"; Color="Gray"},
    @{Name="ğŸ“ TeraCopy"; Id="CodeSector.TeraCopy"; Category="Utilities"; Color="Gray"},
    @{Name="ğŸ’¿ CDBurnerXP"; Id="Canneverbe.CDBurnerXP"; Category="Utilities"; Color="Gray"},
    @{Name="ğŸ—‘ï¸ Revo Uninstaller"; Id="RevoUninstaller.RevoUninstaller"; Category="Utilities"; Color="Gray"},
    @{Name="âŒ¨ï¸ Launchy"; Id="Launchy.Launchy"; Category="Utilities"; Color="Gray"},
    @{Name="ğŸ“Š WinDirStat"; Id="WinDirStat.WinDirStat"; Category="Utilities"; Color="Gray"},
    @{Name="ğŸŒ² WizTree"; Id="AntibodySoftware.WizTree"; Category="Utilities"; Color="Gray"},
    @{Name="ğŸ› ï¸ Glary Utilities"; Id="Glarysoft.GlaryUtilities"; Category="Utilities"; Color="Gray"},
    @{Name="ğŸ’¿ InfraRecorder"; Id="ChristianKindahl.InfraRecorder"; Category="Utilities"; Color="Gray"},
    @{Name="ğŸš€ Open-Shell"; Id="Open-Shell.Open-Shell-Menu"; Category="Utilities"; Color="Gray"},
    @{Name="ğŸ§¹ CCleaner"; Id="Piriform.CCleaner"; Category="Utilities"; Color="Gray"},
    @{Name="ğŸ’¿ Rufus"; Id="Rufus.Rufus"; Category="Utilities"; Color="Gray"},
    @{Name="âš¡ PowerToys"; Id="Microsoft.PowerToys"; Category="Utilities"; Color="Gray"},
    @{Name="ğŸ–¥ï¸ CPU-Z"; Id="CPUID.CPU-Z"; Category="Utilities"; Color="Gray"},

    # ğŸ“¦ Compression (75-77)
    @{Name="ğŸ“¦ 7-Zip"; Id="7zip.7zip"; Category="Compression"; Color="Yellow"},
    @{Name="ğŸ—œï¸ PeaZip"; Id="Giorgiotani.Peazip"; Category="Compression"; Color="Yellow"},
    @{Name="ğŸ“¦ WinRAR"; Id="RARLab.WinRAR"; Category="Compression"; Color="Yellow"},

    # âš™ï¸ Runtimes - VC++ (78-90)
    @{Name="âš™ï¸ VC++ 2015+ x64"; Id="Microsoft.VCRedist.2015+.x64"; Category="Runtimes"; Color="DarkGray"},
    @{Name="âš™ï¸ VC++ 2015+ x86"; Id="Microsoft.VCRedist.2015+.x86"; Category="Runtimes"; Color="DarkGray"},
    @{Name="âš™ï¸ VC++ 2015+ ARM64"; Id="Microsoft.VCRedist.2015+.arm64"; Category="Runtimes"; Color="DarkGray"},
    @{Name="âš™ï¸ VC++ 2013 x64"; Id="Microsoft.VCRedist.2013.x64"; Category="Runtimes"; Color="DarkGray"},
    @{Name="âš™ï¸ VC++ 2013 x86"; Id="Microsoft.VCRedist.2013.x86"; Category="Runtimes"; Color="DarkGray"},
    @{Name="âš™ï¸ VC++ 2012 x64"; Id="Microsoft.VCRedist.2012.x64"; Category="Runtimes"; Color="DarkGray"},
    @{Name="âš™ï¸ VC++ 2012 x86"; Id="Microsoft.VCRedist.2012.x86"; Category="Runtimes"; Color="DarkGray"},
    @{Name="âš™ï¸ VC++ 2010 x64"; Id="Microsoft.VCRedist.2010.x64"; Category="Runtimes"; Color="DarkGray"},
    @{Name="âš™ï¸ VC++ 2010 x86"; Id="Microsoft.VCRedist.2010.x86"; Category="Runtimes"; Color="DarkGray"},
    @{Name="âš™ï¸ VC++ 2008 x64"; Id="Microsoft.VCRedist.2008.x64"; Category="Runtimes"; Color="DarkGray"},
    @{Name="âš™ï¸ VC++ 2008 x86"; Id="Microsoft.VCRedist.2008.x86"; Category="Runtimes"; Color="DarkGray"},
    @{Name="âš™ï¸ VC++ 2005 x64"; Id="Microsoft.VCRedist.2005.x64"; Category="Runtimes"; Color="DarkGray"},
    @{Name="âš™ï¸ VC++ 2005 x86"; Id="Microsoft.VCRedist.2005.x86"; Category="Runtimes"; Color="DarkGray"},

    # âš™ï¸ .NET & Development (91-108)
    @{Name="âš™ï¸ .NET 4.8.1"; Id="Microsoft.DotNet.Framework.DeveloperPack_4"; Category="Runtimes"; Color="DarkGray"},
    @{Name="ğŸ Python 3"; Id="Python.Python.3.12"; Category="Development"; Color="Blue"},
    @{Name="ğŸ Python 2.7"; Id="Python.Python.2"; Category="Development"; Color="Blue"},
    @{Name="ğŸ”§ Git"; Id="Git.Git"; Category="Development"; Color="Blue"},
    @{Name="ğŸ“¡ FileZilla"; Id="TimKosse.FileZilla.Client"; Category="Development"; Color="Blue"},
    @{Name="ğŸ“ Notepad++"; Id="Notepad++.Notepad++"; Category="Development"; Color="Blue"},
    @{Name="ğŸ” WinSCP"; Id="WinSCP.WinSCP"; Category="Development"; Color="Blue"},
    @{Name="ğŸ–¥ï¸ PuTTY"; Id="PuTTY.PuTTY"; Category="Development"; Color="Blue"},
    @{Name="ğŸ”€ WinMerge"; Id="WinMerge.WinMerge"; Category="Development"; Color="Blue"},
    @{Name="â˜• Eclipse"; Id="EclipseAdoptium.Temurin.21.JDK"; Category="Development"; Color="Blue"},
    @{Name="ğŸ’» VS Code"; Id="Microsoft.VisualStudioCode"; Category="Development"; Color="Blue"},
    @{Name="ğŸ¤– Cursor"; Id="Anysphere.Cursor"; Category="Development"; Color="Blue"},
    @{Name="ğŸŸ¢ Node.js"; Id="OpenJS.NodeJS"; Category="Development"; Color="Blue"},
    @{Name="ğŸ’ Ruby"; Id="RubyInstallerTeam.Ruby.3.2"; Category="Development"; Color="Blue"},
    @{Name="ğŸ˜ PostgreSQL"; Id="PostgreSQL.PostgreSQL"; Category="Development"; Color="Blue"},
    @{Name="ğŸ¬ MySQL"; Id="Oracle.MySQL"; Category="Development"; Color="Blue"},
    @{Name="ğŸ“Š Tableau"; Id="Tableau.TableauPublic"; Category="Development"; Color="Blue"},
    @{Name="â¬‡ï¸ IDM"; Id="Tonec.InternetDownloadManager"; Category="Downloads"; Color="Green"}
)

function Test-AdminPrivileges {
    $currentUser = [Security.Principal.WindowsIdentity]::GetCurrent()
    $principal = New-Object Security.Principal.WindowsPrincipal($currentUser)
    return $principal.IsInRole([Security.Principal.WindowsBuiltInRole]::Administrator)
}

function Show-Header {
    $headerText = @"
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘     â–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—       â•‘
â•‘     â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â•šâ•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â•šâ•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â•       â•‘
â•‘     â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â–ˆâ–ˆâ–ˆâ–ˆâ•”â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—         â•‘
â•‘     â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•”â•â•â•         â•‘
â•‘     â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘ â•šâ•â• â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—       â•‘
â•‘      â•šâ•â•â•â•â•â• â•šâ•â•â•â•â•â•â•â•šâ•â•   â•šâ•â•â•šâ•â•     â•šâ•â•â•šâ•â•  â•šâ•â•   â•šâ•â•   â•šâ•â•â•â•â•â•â•       â•‘
â•‘              ğŸ›¡ï¸  SAFE PC INSTALLER V4.0 - COLOR CODED ğŸ›¡ï¸                 â•‘
â•‘                          Made by: MD Adnan                                â•‘
â•‘      100% SAFE â€¢ NO REGISTRY â€¢ NO FILE DELETION â€¢ WINGET ONLY             â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
"@
    Write-Host $headerText -ForegroundColor $Colors.Primary
    Write-Host "`n  ğŸ“¦ Total Apps: " -NoNewline -ForegroundColor $Colors.Warning
    Write-Host "$($softwareList.Count)" -ForegroundColor $Colors.Success
    Write-Host "  ğŸ” Admin: " -NoNewline -ForegroundColor $Colors.Warning
    Write-Host $(if (Test-AdminPrivileges) { "âœ… Yes" } else { "âŒ No" }) -ForegroundColor $(if (Test-AdminPrivileges) { $Colors.Success } else { $Colors.Error })
    Write-Host ""
}

function Show-Menu {
    Write-Host "â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”" -ForegroundColor $Colors.Warning
    Write-Host "â”‚                        âš¡ ACTIONS âš¡                                       â”‚" -ForegroundColor $Colors.Warning
    Write-Host "â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜" -ForegroundColor $Colors.Warning
    Write-Host ""
    Write-Host "  [I] ğŸ“¥ Install  |  [U] ğŸ—‘ï¸ Uninstall  |  [L] ğŸ“‹ List  |  [A] ğŸ”„ Update All  |  [C] ğŸ¨ Categories  |  [Q] âŒ Quit" -ForegroundColor $Colors.Info
    Write-Host ""
    Write-Host "â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”" -ForegroundColor DarkCyan
    Write-Host "â”‚ ğŸ“¦ 108 APPS - COLOR CODED BY CATEGORY                                    â”‚" -ForegroundColor $Colors.Info
    Write-Host "â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜" -ForegroundColor DarkCyan
    Write-Host ""

    $total = $softwareList.Count
    $columns = 3
    $rows = [Math]::Ceiling($total / $columns)

    for ($row = 0; $row -lt $rows; $row++) {
        for ($col = 0; $col -lt $columns; $col++) {
            $index = $row + ($col * $rows)
            if ($index -lt $total) {
                $num = $index + 1
                $app = $softwareList[$index]
                $numStr = if ($num -lt 10) { " [$num]  " } elseif ($num -lt 100) { "[$num] " } else { "[$num]" }
                
                Write-Host $numStr -NoNewline -ForegroundColor White
                Write-Host $app.Name.PadRight(30) -NoNewline -ForegroundColor $app.Color
            }
        }
        Write-Host ""
    }
    
    Write-Host "`nğŸ’¡ " -NoNewline -ForegroundColor Gray
    Write-Host "Colors: " -NoNewline -ForegroundColor Gray
    Write-Host "Cyan=Browser/Cloud " -NoNewline -ForegroundColor Cyan
    Write-Host "Green=Comm " -NoNewline -ForegroundColor Green
    Write-Host "Magenta=Media " -NoNewline -ForegroundColor Magenta
    Write-Host "Yellow=Graphics " -NoNewline -ForegroundColor Yellow
    Write-Host "Red=Security " -NoNewline -ForegroundColor Red
    Write-Host "Blue=Dev" -ForegroundColor Blue
    Write-Host "ğŸ’¡ Examples: '1' | '35-37' (MS Office) | '1,7,100,108'" -ForegroundColor Gray
}

function Show-ByCategory {
    Clear-Host
    Show-Header
    
    $categories = $softwareList | Group-Object -Property Category | Sort-Object Name
    
    Write-Host "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—" -ForegroundColor Cyan
    Write-Host "â•‘                    ğŸ“‚ SOFTWARE BY CATEGORY                                â•‘" -ForegroundColor Cyan
    Write-Host "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•" -ForegroundColor Cyan
    
    foreach ($category in $categories) {
        $catName = $category.Name
        $color = $category.Group[0].Color
        
        Write-Host "`nâ”Œâ”€ " -NoNewline -ForegroundColor DarkGray
        Write-Host "$catName ($($category.Count) apps)" -ForegroundColor $color
        Write-Host "â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€" -ForegroundColor DarkGray
        
        foreach ($app in $category.Group) {
            $num = $softwareList.IndexOf($app) + 1
            Write-Host "   [$num] " -NoNewline -ForegroundColor White
            Write-Host "$($app.Name)" -ForegroundColor $color
        }
    }
    Write-Host ""
    Pause
}

function Install-Software {
    param([array]$items)
    Clear-Host
    Write-Host "ğŸ›¡ï¸ INSTALLING SOFTWARE (SILENT MODE)..." -ForegroundColor $Colors.Success
    Write-Host "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”" -ForegroundColor DarkGray

    $successCount = 0
    $failCount = 0

    foreach ($app in $items) {
        Write-Host "`nğŸ“¦ " -NoNewline
        Write-Host "$($app.Name)" -ForegroundColor $app.Color
        Write-Host "   ID: $($app.Id)" -ForegroundColor DarkGray
        
        winget install --id $app.Id --silent --accept-package-agreements --accept-source-agreements 2>&1 | Out-Null
        
        if ($LASTEXITCODE -eq 0) {
            Write-Host "   âœ… Installed!" -ForegroundColor $Colors.Success
            $successCount++
        } else {
            Write-Host "   âš ï¸ Skipped" -ForegroundColor $Colors.Warning
            $failCount++
        }
    }
    
    Write-Host "`nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”" -ForegroundColor DarkGray
    Write-Host "âœ… COMPLETE! Success: $successCount | Skipped: $failCount" -ForegroundColor $Colors.Success
    Pause
}

function Uninstall-Software {
    Clear-Host
    Show-Header
    Write-Host "ğŸ—‘ï¸ Enter number to uninstall: " -NoNewline -ForegroundColor $Colors.Warning
    $input = Read-Host

    if ($input -match '^\d+$') {
        $idx = [int]$input - 1
        if ($idx -ge 0 -and $idx -lt $softwareList.Count) {
            $app = $softwareList[$idx]
            Write-Host "`nğŸ“¦ Target: " -NoNewline
            Write-Host "$($app.Name)" -ForegroundColor $app.Color
            Write-Host "Confirm? (Y/N): " -NoNewline -ForegroundColor $Colors.Warning
            if ((Read-Host) -match '^[Yy]$') {
                winget uninstall --id $app.Id --silent --accept-source-agreements
                Write-Host "`nâœ… Done!" -ForegroundColor $Colors.Success
            }
        } else {
            Write-Host "`nâŒ Invalid number!" -ForegroundColor $Colors.Error
        }
    }
    Pause
}

function List-InstalledSoftware {
    Clear-Host
    Show-Header
    Write-Host "ğŸ“‹ Installed Software:" -ForegroundColor $Colors.Info
    winget list --accept-source-agreements
    Pause
}

function Update-AllSoftware {
    Clear-Host
    Write-Host "ğŸ”„ Updating All Software..." -ForegroundColor $Colors.Highlight
    winget upgrade --all --silent --accept-package-agreements --accept-source-agreements
    Write-Host "`nâœ… Updates Complete!" -ForegroundColor $Colors.Success
    Pause
}

function Parse-InputSelection {
    param([string]$inputString)
    $validApps = New-Object System.Collections.ArrayList
    $parts = $inputString -split ',' | ForEach-Object { $_.Trim() }
    
    foreach ($part in $parts) {
        if ($part -match '^(\d+)-(\d+)$') {
            $start = [int]$Matches[1]
            $end = [int]$Matches[2]
            for ($i = $start; $i -le $end; $i++) {
                $idx = $i - 1
                if ($idx -ge 0 -and $idx -lt $softwareList.Count) {
                    [void]$validApps.Add($softwareList[$idx])
                }
            }
        }
        elseif ($part -match '^\d+$') {
            $idx = [int]$part - 1
            if ($idx -ge 0 -and $idx -lt $softwareList.Count) {
                [void]$validApps.Add($softwareList[$idx])
            }
        }
    }
    return $validApps.ToArray()
}

# MAIN LOOP
do {
    Clear-Host
    Show-Header
    Show-Menu
    Write-Host "`nğŸ‘‰ Your choice: " -NoNewline -ForegroundColor $Colors.Highlight
    $choice = Read-Host

    switch ($choice.ToUpper()) {
        "I" {
            Write-Host "Enter number(s): " -NoNewline -ForegroundColor $Colors.Info
            $userInput = Read-Host
            $validApps = Parse-InputSelection -inputString $userInput
            
            if ($validApps.Count -gt 0) {
                Write-Host "`nğŸ“¦ Selected:" -ForegroundColor $Colors.Info
                foreach ($app in $validApps) {
                    Write-Host "   â€¢ " -NoNewline
                    Write-Host "$($app.Name)" -ForegroundColor $app.Color
                }
                Write-Host "`nProceed? (Y/N): " -NoNewline -ForegroundColor $Colors.Warning
                if ((Read-Host) -match '^[Yy]$') {
                    Install-Software -items $validApps
                }
            } else {
                Write-Host "âŒ Invalid input!" -ForegroundColor $Colors.Error
                Pause
            }
        }
        "U" { Uninstall-Software }
        "L" { List-InstalledSoftware }
        "A" { Update-AllSoftware }
        "C" { Show-ByCategory }
        "Q" { 
            Write-Host "`nâœ… Thank you! Your PC is safe." -ForegroundColor $Colors.Success
            break 
        }
        default {
            Write-Host "âŒ Invalid! Use: I, U, L, A, C, or Q" -ForegroundColor $Colors.Error
            Start-Sleep -Seconds 2
        }
    }
} while ($true)